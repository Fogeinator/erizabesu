{"version":3,"file":"erizabesu.js","sources":["../src/index.js"],"sourcesContent":["import { h, Component } from 'preact';\nimport './style.css';\n\nexport default class Erizabesu extends Component {\n  static defaultProps = { autoPlay: true, allowMouseSwipe: true };\n  state = { boardIndex: 0, transition: true };\n\n  componentDidMount() {\n    this.autoPlay();\n    this.dataLength = this.props.data.length;\n\n    this.boards.addEventListener('mousedown', this.onMouseDown);\n    this.boards.addEventListener('touchstart', this.onSwipeStart);\n    this.boards.addEventListener('touchmove', this.onSwipeMove);\n    this.boards.addEventListener('touchend', this.onSwipeEnd);\n  }\n\n  componentWillUnmount() {\n    this.clearAutoPlay();\n\n    this.boards.removeEventListener('mousedown', this.onMouseDown);\n    this.boards.removeEventListener('touchstart', this.onSwipeStart);\n    this.boards.removeEventListener('touchmove', this.onSwipeMove);\n    this.boards.removeEventListener('touchend', this.onSwipeEnd);\n  }\n\n  autoPlay = () => {\n    if (this.props.autoPlay && !this.interval) {\n      this.interval = setInterval(this.nextBoard, 2000);\n    }\n  };\n\n  clearAutoPlay = () => {\n    if (this.interval) {\n      clearInterval(this.interval);\n      this.interval = null;\n    }\n  };\n\n  nextBoard = () => {\n    this.setState({\n      boardIndex: (this.state.boardIndex + 1) % this.dataLength\n    });\n  };\n\n  onSwipeStart = e => {\n    this.clearAutoPlay();\n    this.setState({ transition: false });\n    this.startX = getX(e);\n    this.startIndex = this.state.boardIndex;\n  };\n\n  onSwipeMove = e => {\n    const deltaX = getX(e) - this.startX;\n    this.setState({\n      boardIndex: this.startIndex - deltaX / this.boards.clientWidth\n    });\n  };\n\n  onSwipeEnd = e => {\n    this.autoPlay();\n    this.setState({ transition: true });\n    let boardIndex = this.state.boardIndex;\n    if (boardIndex < 0) {\n      boardIndex = 0;\n    } else if (boardIndex > this.dataLength - 1) {\n      boardIndex = this.dataLength - 1;\n    } else {\n      boardIndex = Math.round(this.state.boardIndex);\n    }\n    this.setState({ boardIndex });\n  };\n\n  onMouseDown = e => {\n    e.preventDefault();\n    if (this.props.allowMouseSwipe) {\n      this.mouseDown = true;\n      document.addEventListener('mouseup', this.onMouseUp);\n      document.addEventListener('mousemove', this.onMouseMove);\n      this.onSwipeStart(e);\n    }\n  };\n\n  onMouseMove = e => {\n    if (this.mouseDown) {\n      this.onSwipeMove(e);\n    }\n  };\n\n  onMouseUp = e => {\n    this.mouseDown = false;\n    document.removeEventListener('mouseup', this.onMouseUp);\n    document.removeEventListener('mousemove', this.onMouseMove);\n    this.onSwipeEnd(e);\n  };\n\n  onBoardClick = e => {\n    if (this.startX !== getX(e)) {\n      e.preventDefault();\n    }\n  };\n\n  render({ data, className, indicator, ...props }, { boardIndex, transition }) {\n    return (\n      <div\n        {...props}\n        class={['erizabesu', props.class, className].filter(Boolean).join(' ')}\n      >\n        <div\n          ref={c => (this.boards = c)}\n          class=\"boards\"\n          style={\n            transition\n              ? {\n                  transform: `translateX(${-boardIndex * 100}%)`,\n                  transition: 'transform 0.5s ease'\n                }\n              : {\n                  transform: `translateX(${-boardIndex * 100}%)`\n                }\n          }\n        >\n          {data.map(board => (\n            <a\n              class=\"board\"\n              href={board.href}\n              target={board.target}\n              onClick={this.onBoardClick}\n              style={{ backgroundImage: `url(${board.img})` }}\n            />\n          ))}\n        </div>\n        {indicator\n          ? h(indicator, { num: data.length, index: boardIndex }, null)\n          : ''}\n      </div>\n    );\n  }\n}\n\nfunction getX(e) {\n  if ('touches' in e) {\n    return e.touches[0].pageX;\n  }\n  return e.screenX;\n}\n"],"names":["Erizabesu","state","boardIndex","transition","autoPlay","props","interval","setInterval","nextBoard","clearAutoPlay","setState","dataLength","onSwipeStart","startX","getX","e","startIndex","onSwipeMove","deltaX","boards","clientWidth","onSwipeEnd","Math","round","onMouseDown","preventDefault","allowMouseSwipe","mouseDown","addEventListener","onMouseUp","onMouseMove","removeEventListener","onBoardClick","componentDidMount","data","length","componentWillUnmount","render","className","indicator","h","class","filter","Boolean","join","c","map","board","href","target","backgroundImage","img","num","index","Component","defaultProps","touches","pageX","screenX"],"mappings":"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"}